@using Duende.IdentityServer.Extensions
@{
    string name = null;
    if (!true.Equals(ViewData["signed-out"]))
    {
        name = Context.User?.GetDisplayName();
    }
}

<nav>
        <div class="burger-container">
        <div class="burger" id="burger">
            <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                <rect x="4" y="6" width="24" height="3" fill="white"/>
                <rect x="4" y="14.5" width="20" height="3" fill="#808080"/>
                <rect x="4" y="23" width="24" height="3" fill="white"/>
                <path d="M26 16l-5 5V11l5 5z" fill="white"/>
            </svg>
        </div>
        </div>
        <div class="title">
            <a href="~/" class="nav-brand">
                <img src="~/duende-logo.svg" class="icon-banner" alt="Duende IdentityServer">
                Duende IdentityServer
            </a>
        </div>

        <div class="menu-container">
            <div class="theme-menu">
                <button id="theme-button" aria-haspopup="true" aria-expanded="false" aria-controls="theme-menu-list">
                    <i class="fas fa-palette"></i>
                    <span class="label">
                        <span>Theme</span>
                    </span>
                    <span class="chevron">▼</span>
                </button>
                <ul id="theme-menu-list" class="dropdown" role="menu">
                    <li><a href="#" data-theme="light">Light</a></li>
                    <li><a href="#" data-theme="dark">Dark</a></li>
                    <li><a href="#" data-theme="blue">Blue</a></li>
                    <li><a href="#" data-theme="green">Green</a></li>
                    <li><a href="#" data-theme="purple">Purple</a></li>
                </ul>
            </div>
            <div>
                <button id="menu-button" aria-haspopup="menu" aria-expanded="false" aria-controls="menu">
                    <i class="fas fa-user"></i>
                    <span class="label">
                        <span>@(string.IsNullOrWhiteSpace(name) ? "Login" : name)</span>
                    </span>
                    <span class="chevron">▼</span>
                </button>
                <ul id="menu" class="dropdown" role="menu">
                    @if (!string.IsNullOrWhiteSpace(name))
                    {
                        @if (User.IsInRole("ADMIN"))
                        {
                            <li>
                                <a asp-page="/Admin/Clients/Index">Manage Clients</a>
                            </li>
                            <li>
                                <a asp-page="/Admin/Users/Index">Manage Users</a>
                            </li>
                        }

                        <li>
                            <a asp-page="/Account/Logout/Index">Logout</a>
                        </li>
                    }
                    else
                    {
                        <li>
                            <a class="nav-link" asp-page="/Account/Register/Index">Register</a>
                        </li>
                        <li>
                            <a class="nav-link" asp-page="/Account/Login/Index">Login</a>
                        </li>
                    }
                </ul>
            </div>
        </div>


    </nav>

<!-- Moved inline script to external file -->
<script src="~/js/nav.js"></script>
<script src="~/js/theme-switcher.js"></script>
